<!DOCTYPE html>
<html>
<head>
<title>Class Access</title>
<script type="text/javascript" src="//www.gettips.com/mobile/jquery-1.12.4.min.js"></script>
<script type="text/javascript">
$(document).bind("mobileinit", function () {
    $.ajaxSetup({ "async": false, "cache": false, "crossDomain": true });
    $.mobile.allowCrossDomainPages = true;
    $.mobile.loadingMessage = false;
    if (navigator.userAgent.toLowerCase().indexOf("msie") != -1) {
        $.mobile.allowCrossDomainPages = true;
        $.support.cors = true;
    }
});
</script>
<link rel="stylesheet" href="//www.gettips.com/mobile/jquery.mobile-1.3.2.css">
<link rel="stylesheet" href="//www.gettips.com/mobile/css/customizations.css">
<script src="//www.gettips.com/mobile/js/jquery.mobile-1.3.2.min.js"></script>
<script src="//www.gettips.com/js/wtooltip.js" type="text/javascript"></script>
<style type="text/css">
        #reg .c-interior {
            padding: 0px;
            margin: 0px;
            background-color: #f9f9f9;
            margin: 0px;
        }

        #reg .ui-header {
            background-image: none;
            padding-top: 20px;
            text-align: center;
            height: 40px;
            color: #b6bdca;
            font-size: .9em;
        }

        a#navbutton1 a#navbutton2 a#navbutton3 a#navbutton4 a#navbutton5 a#navbutton6 {
            border: 0px;
            background-image: none;
            background-color: #5EA5E1;
            width: 90%;
            color: #fff;
            padding: 16px 19px;
            text-transform: uppercase;
            margin: 0px auto;
            -webkit-border-radius: 3px;
            -moz-border-radius: 3px;
            border-radius: 3px;
            font-family: 'Source Sans Pro', Helvetica, sans-serif;
            opacity: 1;
            text-indent: 0px;
        }

        body {
            font-family: 'Source Sans Pro', Helvetica, sans-serif;
            font-size: 17pt;
            background-color: #3e4553;
            background-image: none;
        }
</style>
<link rel="stylesheet" href="//www.gettips.com/mobile/css/themes/isellsafe.css" />
<link rel="stylesheet" href="//www.gettips.com/mobile/css/themes/pbsa.css" />
<script type="text/javascript">
        var loggedIn = false;
        var hosting = baseDomainString();
        var myprotocol = document.location.protocol;
        var pathArray = window.location.pathname.split('?');
        var mylocation = window.location.protocol + "//" + window.location.host + pathArray[0];
        var urlBase = location.href.substring(0, location.href.lastIndexOf("/") + 1);
        var LangCd = 'ENU';
        var saveRedirect = document.location.hash;

        // Parameters
        var ClassId = getUrlParameter('CID');
        if (ClassId == undefined || ClassId == "") {
            ClassId = getUrlParameter('OFR');
            if (ClassId == undefined) { ClassId = ""; }
        }
        var RegId = getUrlParameter('RG');
        if (RegId == undefined) { RegId = ''; }
        var uid = getUrlParameter('UID');
        if (uid == null || typeof (uid) == "undefined") { uid = ""; }
        var sessid = getUrlParameter('SES');
        if (sessid == null || typeof (sessid) == "undefined") { sessid = ""; }
        var domain = getUrlParameter('PP');
        if (domain == undefined) { domain = 'TIPS'; }
        var LangCd = getUrlParameter('LANG');
        if (LangCd == undefined || LangCd == '') { LangCd = 'ENU'; }
        var savesource = getUrlParameter('CUR');
        if (savesource == undefined || savesource == "") {
            savesource = document.referrer;
            if (savesource == undefined) { savesource = ""; }
        }
        if (savesource == "") { savesource = "https://www.gettips.com/mobile/index.html#reg"; }

        // Declarations
        var relogin = false;
        var RegLink = "";
        var RegList = "";
        var PaymentLink = "";
        var ClassLink = "";
        var ReviewReg = "";
        var NextLink = "";
        var Refresh = 0;
        var TYPE_CD = "";
        var MSG1 = "";
        var DOMAIN = "";
        var ErrMsg = "";

        function breakout_of_frame() {
            if (top.location != location) { top.location.href = document.location.href; }
        }
        function DeviceWidth() {
            var deviceWidth = window.orientation == 0 ? window.screen.width : window.screen.height;
            if (navigator.userAgent.indexOf('Android') >= 0 && window.devicePixelRatio) {
                deviceWidth = deviceWidth / window.devicePixelRatio;
            }
            return deviceWidth;
        }
        // Get base domain
        function baseDomainString() {
            e = document.domain.split(/\./);
            if (e.length > 1) {
                return (e[e.length - 2] + "." + e[e.length - 1]);
            } else {
                return ("");
            }
        }
        function getUrlParameter(sParam) {
            var sPageURL = decodeURIComponent(window.location.search.substring(1)),
                sURLVariables = sPageURL.split('&'),
                sParameterName,
                i;

            for (i = 0; i < sURLVariables.length; i++) {
                sParameterName = sURLVariables[i].split('=');

                if (sParameterName[0] === sParam) {
                    return sParameterName[1] === undefined ? true : sParameterName[1];
                }
            }
        }
        function updateTheme() {
            newTheme = "b";
            if (domain == "ISELLSAFE") { newTheme = "f"; }
            if (domain == "PBSA") { newTheme = "g"; }
            var rmbtnClasses = '';
            var rmhfClasses = '';
            var rmbdClassess = '';
            var arr = ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z"];
            $.each(arr, function (index, value) {
                rmbtnClasses = rmbtnClasses + " ui-btn-up-" + value + " ui-btn-hover-" + value;
                rmhfClasses = rmhfClasses + " ui-bar-" + value;
                rmbdClassess = rmbdClassess + " ui-body-" + value;
            });
            if ($.mobile.activePage) {
                $.mobile.activePage.find('.ui-btn').not('.ui-li-divider').removeClass(rmbtnClasses).addClass('ui-btn-up-' + newTheme).attr('data-theme', newTheme);
                if (newTheme != "b") {
                    $.mobile.activePage.find('.ui-btn').removeClass(rmbtnClasses).addClass('ui-btn-' + newTheme).attr('data-theme', newTheme);
                }
                $.mobile.activePage.find('.ui-bar').not('.ui-li-divider').removeClass(rmbtnClasses).addClass('ui-btn-up-' + newTheme).attr('data-theme', newTheme);
                $.mobile.activePage.find('.ui-header, .ui-footer').removeClass(rmhfClasses).addClass('ui-bar-' + newTheme).attr('data-theme', newTheme);
                $.mobile.activePage.find('.ui-input-text').removeClass(rmhfClasses).addClass('ui-input-text-' + newTheme).attr('data-theme', newTheme);
                $.mobile.activePage.removeClass(rmbdClassess).addClass('ui-body-' + newTheme).attr('data-theme', newTheme);
                $.mobile.activePage.find('.ui-select').removeClass(rmhfClasses).addClass('ui-select-' + newTheme).attr('data-theme', newTheme);
                $.mobile.activePage.find('.ui-btn').removeClass(rmhfClasses).addClass('ui-btn-' + newTheme).attr('data-theme', newTheme);
                $.mobile.activePage.find('.ui-btn-hover').removeClass(rmhfClasses).addClass('ui-btn-hover-' + newTheme).attr('data-theme', newTheme);
                $.mobile.activePage.find('.ui-btn-up').removeClass(rmhfClasses).addClass('ui-btn-up-' + newTheme).attr('data-theme', newTheme);
            }
        }
        function readCookie(name) {
            var nameEQ = name + "=";
            var ca = document.cookie.split(';');
            for (var i = 0; i < ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') c = c.substring(1, c.length);
                if (c.indexOf(nameEQ) == 0) { return c.substring(nameEQ.length, c.length); }
            }
            return '';
        }
        function getCookie(name) {
            var test = readCookie(name);
            if (test == null || typeof (test) == "undefined") { test = ""; }
            return test;
        }
        function SetCookie(name, value) {
            var argv = SetCookie.arguments;
            var argc = SetCookie.arguments.length;
            var expires = (argc > 2) ? argv[2] : null;
            var path = (argc > 3) ? argv[3] : null;
            var domain = (argc > 4) ? argv[4] : null;
            var secure = (argc > 5) ? argv[5] : false;
            document.cookie = name + "=" + escape(value) +
                ((path == null) ? "" : ("; path=" + path)) +
                ((domain == null) ? "" : ("; domain=" + domain)) +
                ((secure == true) ? "; secure" : "");
        }
        function loginuser() {
            var expdate = new Date();
            expdate.setTime(expdate.getTime() + 86400000);
            SetCookie("ID", uid, "/", "/", ".certegrity.com");
            SetCookie("Sess", sessid, null, "/", ".certegrity.com");
        }
        function logoutuser(olduid, oldsessid) {
            var expdate = new Date();
            expdate.setTime(expdate.getTime() - 86400000);
            SetCookie("ID", olduid, "/", "/", ".certegrity.com");
            SetCookie("Sess", oldsessid, null, "/", ".certegrity.com");
        }
        function getStatus() {
            breakout_of_frame();
            var relogin = '';
            loggedIn = false;

            // Check parameters
            if (uid == null || typeof (uid) == "undefined") { uid = ""; }
            if (sessid == null || typeof (sessid) == "undefined") { sessid = ""; }

            // Check cookies
            var uid2 = getCookie('ID');
            var sessid2 = getCookie('Sess');
            if (sessid2 == "" || uid2 == "") {
                loginuser();
                uid2 = getCookie('ID');
                sessid2 = getCookie('Sess');
            }
            if (sessid2 == "" || uid2 == "") {
                Msg1 = '<table cellpadding="1" border="0" cellspacing="0" width="100%" height="100%" id="MsgTable" style="padding-top:120px;"><tr><td valign="middle" height="33%" align="center"><h3 style="color:red; align:center;">You are not logged in, and so cannot take this course</h3>'
                    + '</td></tr><tr><td align="Center"><br><br><a href="' + savesource + '#reg" id="ProceedBtn" data-role="button" rel="external" data-theme="c">Click to Continue</a></font></td></tr></table>';
                $("#Msg1").html(Msg1);
                $("#ProceedBtn").button();
                updateTheme();
                $.mobile.hidePageLoadingMsg();
                return;
            }

            // Evaluate cookies
            if (uid != '' && sessid != '') {
                if (uid2 == uid && sessid2 == sessid) {
                    loggedIn = true;
                    getClassInfo();
                    return;
                }
                else {
                    logoutuser(uid2, sessid2);
                    loginuser();
                    uid2 = getCookie('ID');
                    sessid2 = getCookie('Sess');
                    if (uid2 == uid && sessid2 == sessid) {
                        loggedIn = true;
                        getClassInfo();
                        return;
                    }
                    else {
                        Msg1 = '<table cellpadding="1" border="0" cellspacing="0" width="100%" height="100%" id="MsgTable" style="padding-top:80px;"><tr><td valign="middle" height="33%" class="BigHeader" align="center"><font color="Red">There is an issue with your credentials.'
                            + '</td></tr><tr><td align="Center"><br><br><a href="' + savesource + '#reg" id="ProceedBtn" data-role="button" rel="external" data-theme="c">Click to Continue</a></font></td></tr></table>';
                        $("#Msg1").html(Msg1);
                        $("#ProceedBtn").button();
                        updateTheme();
                        return;
                    }
                }
            }

            var request = "/ls/WsCLogin.ashx?UID="
                + uid2 + "&SES=" + sessid2 + "&HP=" + hosting + "&RL=" + relogin + "&FM=M&callback=?";
            $.getJSON(request, function (JSONData) {
                uid = JSONData.ResultSet.Id;
                sessid = JSONData.ResultSet.SessId;
                redirect = JSONData.ResultSet.Redirect;
                errmsg = JSONData.ResultSet.ErrMsg;
                logout = JSONData.ResultSet.LogOut;
                username = JSONData.ResultSet.Username;
                msgSendFrom = JSONData.ResultSet.EmailAddr;
                domain = JSONData.ResultSet.Domain;

                if (errmsg != '') {
                    Msg1 = '<table cellpadding="1" border="0" cellspacing="0" width="100%" height="100%" id="MsgTable" style="padding-top:80px;"><tr><td valign="middle" height="33%" class="BigHeader" align="center"><font color="Red">' + errmsg + '.'
                        + '</td></tr><tr><td align="Center"><br><br><a href="' + savesource + '#reg" id="ProceedBtn" data-role="button" rel="external" data-theme="c">Click to Continue</a></font></td></tr></table>';
                    $("#Msg1").html(Msg1);
                    $("#ProceedBtn").button();
                    updateTheme();
                    loggedIn = false;
                    DeleteCookie("ID", "/", hosting);
                    DeleteCookie("Sess", "/", hosting);
                    uid = '';
                    sessid = '';
                    errmsg = '';
                    return false;
                }
                if (redirect != '') {
                    loggedIn = true;
                    var expdate = new Date();
                    expdate.setTime(expdate.getTime() + 86400000);
                    SetCookie("ID", uid, expdate, "/", "." + hosting);
                    SetCookie("Sess", sessid, expdate, "/", "." + hosting);
                    getClassInfo();
                    return;
                }
            });
        }
        function getClassInfo() {
            if (ClassId == "" && RegId == "") {
                Msg1 = '<table cellpadding="1" border="0" cellspacing="0" width="100%" height="100%" id="MsgTable"><tr><td valign="middle" height="33%" class="BigHeader" align="center"><font color="Red">No class information was specified.'
                    + '</td></tr><tr><td align="Center"><br><br><a href="' + savesource + '#reg" id="navbutton1" data-role="button" rel="external" data-theme="c">Click to Continue</a></font></td></tr></table>';
                $("#Msg1").html(Msg1);
                $("#navbutton1").button();
                updateTheme();
                return;
            }
            var request = "/ls/WsGetClassAccess.ashx?CID=" + ClassId + "&RG=" + RegId
                + "&UID=" + uid + "&SES=" + sessid + "&PP=" + domain + "&HP=" + hosting
                + "&callback=?";
            $.getJSON(request, function (JSONData) {
                $.mobile.hidePageLoadingMsg();
                ErrMsg = JSONData.ResultSet.ErrMsg;
                Refresh = Number(JSONData.ResultSet.Refresh);
                NextLink = JSONData.ResultSet.NextLink;
                if (NextLink == "") { NextLink = savesource; }
                if (ErrMsg != "") {
                    document.title = "Error opening class information";
                    Msg1 = '<table cellpadding="1" border="0" cellspacing="0" width="100%" height="100" id="MsgTable"><tr><td valign="middle" height="33%" align="center" style="color: red;"><h3>' + ErrMsg + '</h3></td></tr>'
                        + '<tr><td align="Center"><br><br><a href="' + NextLink + '" id="navbutton1" data-role="button" rel="external" data-theme="c">Click to Continue</a></td></tr></table>';
                    $("#Msg1").html(Msg1);
                    $("#navbutton1").button();
                    $.mobile.initializePage();
                    updateTheme();
                    if (Refresh > 0) {
                        var count = Refresh;
                        var countdown = setInterval(function () {
                            $("#defaultCountdown").html("<center><br /><br /><br />Please make a choice.  We will be going forward automatically in <b>" + count + " seconds</b></center>");
                            if (count == 0) {
                                clearInterval(countdown);
                                window.location = savesource;
                            }
                            count--;
                        }, 1000);
                    }
                    return;
                }

                // Get results
                MSG1 = JSONData.ResultSet.MSG1;
                RegLink = JSONData.ResultSet.RegLink;
                RegList = JSONData.ResultSet.RegList;
                PaymentLink = JSONData.ResultSet.PaymentLink;
                ClassLink = JSONData.ResultSet.ClassLink;
                ReviewReg = JSONData.ResultSet.ReviewReg;
                NextLink = JSONData.ResultSet.NextLink;

                // Prepare output
                $("#Msg1").html("<br /><br />" + MSG1);
                if (NextLink != "") { $("#navbutton1").button(); }
                if (ReviewReg != "") { $("#navbutton2").button(); }
                if (ClassLink != "") { $("#navbutton3").button(); }
                if (PaymentLink != "") { $("#navbutton4").button(); }
                if (RegList != "") { $("#navbutton5").button(); }
                if (RegLink != "") { $("#navbutton6").button(); }
                $('.ui-page').trigger('create');
                updateTheme();

                if (Refresh > 0 && NextLink != "") {
                    var count = Refresh;
                    var countdown = setInterval(function () {
                        $("#defaultCountdown").html("<center><br /><br /><br />Please make a choice.  We will be going forward automatically in <b>" + count + " seconds</b></center>");
                        if (count == 0) {
                            clearInterval(countdown);
                            window.location = NextLink;
                        }
                        count--;
                    }, 1000);
                    return;
                }
            });
        }
    </script>
</head>
<body>
<div data-role="page" id="reg" data-theme="d" style="text-align: center; background-color: #ffffff;">
	<div class="c-interior" style="text-align: center; background-color: #ffffff; height: 100%;">
		<div data-role="header" data-theme="b" data-position="fixed"><h1>Class Access</h1></div>
		<div data-role="content" style="text-align: center; background-color: #ffffff; height: 30em;"><center>
			<div id="Msg1"></div><br /><br />
			<div id="defaultCountdown"></div>
		</center></div>
	</div>
</div>
</body>
<script type="text/javascript">
// SCREEN ORIENTATION
var lockOrientation = screen.lockOrientation || screen.mozLockOrientation || screen.msLockOrientation;
if (lockOrientation) {
	try { lockOrientation("landscape-primary"); } catch (e) { }
	try { lockOrientation("landscape"); } catch (e) { }
	}

// PAGE EVENTS
$.mobile.resetActivePageHeight = (function (prevHandler) {
	return function () {
		var $window = $(window),
			$page = $("." + $.mobile.activePageClass),
			$content = $page.find(".ui-content"),
			scrollTop;
		scrollTop = $window.scrollTop();
		$content.height(0);
		prevHandler.apply(this, arguments);
		$content.css({ height: "" });
		$window.scrollTop(scrollTop);
		$page.trigger("pageresize");
	};
})($.mobile.resetActivePageHeight);

$(window.document).on("pageinit", function (event) {
	var $page = $(event.target),
	$header = $page.find(".ui-header"),
	$content = $page.find(".ui-content"),
	$fullHeight = $page.find(".ui-fullheight"),
	extraPageHeight = function () {
		return $page.outerHeight() -
				$header.outerHeight() -
				$content.outerHeight();
		};
	if (!$fullHeight.length) {
		return;
	}
	$page.on("pageresize updatelayout", function () {
		$fullHeight
			.filter(":visible:first")
			.each(function () {
				var $element = $(this),
					initHeight = $element.jqmData("init-height");
				if (!initHeight) {
					initHeight = $element.height();
					$element.jqmData("init-height", initHeight);
				}
				if ($element.height() == initHeight && extraPageHeight() <= 0) {
					return;
				}
				$element
					.height(0)
					.height(
						Math.max(
							initHeight,
							extraPageHeight()
						)
					);
			});
	});
});
$(document).on('pageshow', '#reg', function(){
	updateTheme();
	var screen = $.mobile.getScreenHeight();
	var header = $(".ui-header").hasClass("ui-header-fixed") ? $(".ui-header").outerHeight()  - 1 : $(".ui-header").outerHeight();
	var footer = $(".ui-footer").hasClass("ui-footer-fixed") ? $(".ui-footer").outerHeight() - 1 : $(".ui-footer").outerHeight();
	var contentCurrent = $(".ui-content").outerHeight() - $(".ui-content").height();
	var content = screen - header - footer - contentCurrent;
	$(".ui-content").height(content);
});
$.mobile.initializePage();
$("#Msg1").show();
updateTheme();
getStatus();
$.mobile.loading("hide");
$(function () {
//	$('#defaultCountdown').countdown({until: +60, format: 'S', layout:'Please make a choice.  We will be going forward automatically in <b>{sn} {sl}</b>.'});
});
</script>
<!-- begin olark code -->
<script data-cfasync="false" type='text/javascript'>/*<![CDATA[*/window.olark||(function(c){var f=window,d=document,l=f.location.protocol=="https:"?"https:":"http:",z=c.name,r="load";var nt=function(){
f[z]=function(){
(a.s=a.s||[]).push(arguments)};var a=f[z]._={
},q=c.methods.length;while(q--){(function(n){f[z][n]=function(){
f[z]("call",n,arguments)}})(c.methods[q])}a.l=c.loader;a.i=nt;a.p={
0:+new Date};a.P=function(u){
a.p[u]=new Date-a.p[0]};function s(){
a.P(r);f[z](r)}f.addEventListener?f.addEventListener(r,s,false):f.attachEvent("on"+r,s);var ld=function(){function p(hd){
hd="head";return["<",hd,"></",hd,"><",i,' onl' + 'oad="var d=',g,";d.getElementsByTagName('head')[0].",j,"(d.",h,"('script')).",k,"='",l,"//",a.l,"'",'"',"></",i,">"].join("")}var i="body",m=d[i];if(!m){
return setTimeout(ld,100)}a.P(1);var j="appendChild",h="createElement",k="src",n=d[h]("div"),v=n[j](d[h](z)),b=d[h]("iframe"),g="document",e="domain",o;n.style.display="none";m.insertBefore(n,m.firstChild).id=z;b.frameBorder="0";b.id=z+"-loader";if(/MSIE[ ]+6/.test(navigator.userAgent)){
b.src="javascript:false"}b.allowTransparency="true";v[j](b);try{
b.contentWindow[g].open()}catch(w){
c[e]=d[e];o="javascript:var d="+g+".open();d.domain='"+d.domain+"';";b[k]=o+"void(0);"}try{
var t=b.contentWindow[g];t.write(p());t.close()}catch(x){
b[k]=o+'d.write("'+p().replace(/"/g,String.fromCharCode(92)+'"')+'");d.close();'}a.P(2)};ld()};nt()})({
loader: "static.olark.com/jsclient/loader0.js",name:"olark",methods:["configure","extend","declare","identify"]});
olark('api.box.onShow', function() { setOlarkDefaults(); });
olark.identify('4265-332-10-3809');
/*]]>*/</script><noscript><a href="http://www.olark.com/site/4265-332-10-3809/contact" title="Have a question?" target="_blank">Questions? Feedback?</a> powered by <a href="http://www.olark.com?welcome" title="Olark live chat software">Olark live chat software</a></noscript>
<script> olark.configure('system.group', '51304edc3bdd751f673f3f178e566349'); /*Routes to Tech Support*/ </script>

<!-- end olark code -->
</html>
