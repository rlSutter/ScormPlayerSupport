<!DOCTYPE html>
<html>
<head>
<title>Error</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script type="text/javascript" src="//www.gettips.com/mobile/jquery-1.12.4.min.js"></script>
<script type="text/javascript">
    $(document).bind("mobileinit", function () {
        $.ajaxSetup({ "async": false, "cache": false, "crossDomain": true });
        $.mobile.allowCrossDomainPages = true;
        $.mobile.loadingMessage = false;
        if (navigator.userAgent.toLowerCase().indexOf("msie") != -1) {
            $.mobile.allowCrossDomainPages = true;
            $.support.cors = true;
        }
    });
</script>
<link rel="stylesheet" href="//www.gettips.com/mobile/jquery.mobile-1.3.2.css">
<link rel="stylesheet" href="//www.gettips.com/mobile/css/customizations.css">
<script src="//www.gettips.com/mobile/js/jquery.mobile-1.3.2.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.js" language="javascript"></script>
<link href="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css">
<link href="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/helpers/jquery.fancybox-buttons.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/helpers/jquery.fancybox-buttons.js" language="javascript"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/helpers/jquery.fancybox-media.js" language="javascript"></script>
<script type="text/javascript" src="//www.gettips.com/js/swfobject.js" language="javascript"></script>
<script type="text/javascript" src="//www.gettips.com/js/facebox.js"></script>
<script src="//www.gettips.com/js/sessvars_sso.js" type="text/javascript"></script>
<script src="//www.gettips.com/js/wtooltip.js" type="text/javascript"></script>
<link href="//www.gettips.com/css/facebox.css" rel="stylesheet" type="text/css">
<style type="text/css">"
#CourseLocation { height: 100%; }
#reg .c-interior {
	padding: 0px;
	margin: 0px;
}
#reg .ui-header h1 {
	font-size: 16px;
	padding-bottom: 16px;
	text-transform: uppercase;
	color: #b6bdca;
}
div.ui-input-text input.ui-input-text {
	border-radius: 3px;
	background-color: #eee;
	padding: 15px 30px;
	width: 100%;
	font-size: 12pt;
	box-sizing: border-box;
	margin-top: 10px;
	font-family: 'Source Sans Pro', Helvetica, sans-serif;
	text-shadow: none;
	color: #666;
}
</style>
<link rel="stylesheet" href="//www.gettips.com/mobile/css/themes/isellsafe.css" />
<link rel="stylesheet" href="//www.gettips.com/mobile/css/themes/pbsa.css" />
<script language="javascript">
    var loggedIn = false;
    var hosting = baseDomainString();
    var myprotocol = document.location.protocol;
    var pathArray = window.location.pathname.split('?');
    var mylocation = window.location.protocol + "//" + window.location.host + pathArray[0];
    var urlBase = location.href.substring(0, location.href.lastIndexOf("/") + 1);
    var LangCd = 'ENU';
    var saveRedirect = document.location.hash;

    // Parameters
    var RegId = getUrlParameter('RID');
    if (RegId == undefined) { RegId = ''; }
    var domain = getUrlParameter('PP');
    if (domain == undefined) { domain = 'TIPS'; }
    var uid = getUrlParameter('UID');
    if (uid == null || typeof (uid) == "undefined") { uid = ""; }
    var sessid = getUrlParameter('SES');
    if (sessid == null || typeof (sessid) == "undefined") { sessid = ""; }
    var LangCd = getUrlParameter('LANG');
    if (LangCd == undefined || LangCd == '') { LangCd = 'ENU'; }
    if (LangCd == "ESN") {
        ProceedMsg = 'Haz click para Continuar';
        ReturnLink = 'https://www.gettips.com/mobile/ESN/index.html#reg';
    } else {
        ProceedMsg = 'Click to Continue';
        ReturnLink = 'https://www.gettips.com/mobile/index.html#reg';
    }
    var ErrMsg = "";
    ErrMsg = getUrlParameter('ERR');
    if (ErrMsg == undefined || ErrMsg == '') {
        if (LangCd == "ESN") {
            ErrMsg = 'Se ha reportado un error';
        } else {
            ErrMsg = 'An error has been reported';
        }
    }
    ErrMsg = ErrMsg.replace(/\+/g, ' ');
    var ErrDetail = getUrlParameter('EDTL');
    if (ErrDetail == undefined) { ErrDetail = ""; }
    ErrDetail = ErrDetail.replace(/\+/g,' ');
    //var ReturnLink = getUrlParameter('RTN');
    //if (ReturnLink == undefined || ReturnLink == "") { ReturnLink = 'https://www.gettips.com/mobile/index.html#reg'; }

    // Set if the user redirects from this page to a course player
    var lRedirect = '';

    // Document init
    $(document).ready(function () {
        $("a").wTooltip({
            style: {
                fontFamily: "Arial, Helvetica, sans-serif",
                fontSize: "11"
            }
        });
    });
    $("Class").load(function () {
        var c = (this.contentWindow || this.contentDocument);
        if (c.document) d = c.document;
        $(this).css({
            height: $(d).outerHeight(),
            width: $(d).outerWidth()
        });
    });
    function breakout_of_frame() {
        if (top.location != location) {
            top.location.href = document.location.href;
        }
    }
    function DeviceWidth() {
        var deviceWidth = window.orientation == 0 ? window.screen.width : window.screen.height;
        if (navigator.userAgent.indexOf('Android') >= 0 && window.devicePixelRatio) {
            deviceWidth = deviceWidth / window.devicePixelRatio;
        }
        return deviceWidth;
    }
    // Get base domain
    function baseDomainString() {
        e = document.domain.split(/\./);
        if (e.length > 1) {
            return (e[e.length - 2] + "." + e[e.length - 1]);
        } else {
            return ("");
        }
    }
    function getUrlParameter(sParam) {
        var sPageURL = decodeURIComponent(window.location.search.substring(1)),
            sURLVariables = sPageURL.split('&'),
            sParameterName,
            i;

        for (i = 0; i < sURLVariables.length; i++) {
            sParameterName = sURLVariables[i].split('=');

            if (sParameterName[0] === sParam) {
                return sParameterName[1] === undefined ? true : sParameterName[1];
            }
        }
    }
    function DoCommand(szCommand) {
        if (szCommand == "closewindow") {
            window.close();
            parent.window.close();
        }
        if (szCommand == "close") {
            window.close();
            parent.window.close();
        }
    }
    function openNewWin2(fileName, theWidth, theHeight) {
        DocWindow = window.open(fileName, "Option", "toolbar=0,location=0,directories=0,status=0,menubar=0,scrollbars=1,resizable=1,width=" + theWidth + ",height=" + theHeight)
    }
    function pausecomp(millis) {
        var date = new Date();
        var curDate = null;
        do { curDate = new Date(); }
        while (curDate - date < millis);
    }
    function DeleteCookie(name, path, domain) {
        document.cookie = name + "=" + ((path) ? ";path=" + path : "") + ((domain) ? ";domain=" + domain : "") + ";expires=Thu, 01-Jan-1970 00:00:01 GMT";
    }
    function readCookie(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(';');
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) == ' ') c = c.substring(1, c.length);
            if (c.indexOf(nameEQ) == 0) { return c.substring(nameEQ.length, c.length); }
        }
        return '';
    }
    function SetCookie(name, value) {
        var argv = SetCookie.arguments;
        var argc = SetCookie.arguments.length;
        var expires = (argc > 2) ? argv[2] : null;
        var path = (argc > 3) ? argv[3] : null;
        var domain = (argc > 4) ? argv[4] : null;
        var secure = (argc > 5) ? argv[5] : false;
        document.cookie = name + "=" + escape(value) +
          ((path == null) ? "" : ("; path=" + path)) +
          ((domain == null) ? "" : ("; domain=" + domain)) +
          ((secure == true) ? "; secure" : "");
    }
    function loginuser() {
        var expdate = new Date();
        expdate.setTime(expdate.getTime() + 86400000);
        SetCookie("ID", uid, "/", "/", ".certegrity.com");
        SetCookie("Sess", sessid, null, "/", ".certegrity.com");
    }
    function logoutuser(olduid, oldsessid) {
        var expdate = new Date();
        expdate.setTime(expdate.getTime() - 86400000);
        SetCookie("ID", olduid, "/", "/", ".certegrity.com");
        SetCookie("Sess", oldsessid, null, "/", ".certegrity.com");
    }
    function updateTheme() {
        newTheme = "b";
        if (domain == "ISELLSAFE") { newTheme = "f"; }
        if (domain == "PBSA") { newTheme = "g"; }
        var rmbtnClasses = '';
        var rmhfClasses = '';
        var rmbdClassess = '';
        var arr = ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z"];
        $.each(arr, function (index, value) {
            rmbtnClasses = rmbtnClasses + " ui-btn-up-" + value + " ui-btn-hover-" + value;
            rmhfClasses = rmhfClasses + " ui-bar-" + value;
            rmbdClassess = rmbdClassess + " ui-body-" + value;
        });
        if (newTheme != "b") {
            $.mobile.activePage.find('.ui-btn').removeClass(rmbtnClasses).addClass('ui-btn-' + newTheme).attr('data-theme', newTheme);
        }
    }
    function getCookie(name) {
        var test = readCookie(name);
        if (test == null || typeof (test) == "undefined") { test = ""; }
        return test;
    }
    function getStatus() {
        breakout_of_frame();
        $(".c-interior").css("padding", "");
        $(".c-interior").css("margin", "");
        if (LangCd == "ESN") {
            $("#courseheader").html = 'Se ha reportado un error';
        }
        var relogin = '';
        loggedIn = false;

        // Check parameters
        if (uid == null || typeof (uid) == "undefined") { uid = ""; }
        if (sessid == null || typeof (sessid) == "undefined") { sessid = ""; }

        // Check cookies
        var uid2 = getCookie('ID');
        var sessid2 = getCookie('Sess');
        if (sessid2 == "" || uid2 == "") {
            loginuser();
            uid2 = getCookie('ID');
            sessid2 = getCookie('Sess');
        }
        if (sessid2 == "" || uid2 == "") {
            Msg1 = "";
            if (ErrMsg == "") {
                Msg1 = '<table cellpadding="1" border="0" cellspacing="0" width="100%" height="100%" id="MsgTable" style="padding-top:120px;"><tr><td valign="middle" height="33%" align="center"><h3 style="color:red; align:center;">You are not logged in, and so cannot take this course</h3>'
                        + '</td></tr><tr><td align="Center"><br><br><a href="' + ReturnLink + '" id="ProceedBtn" data-role="button" rel="external" data-theme="c">' + ProceedMsg + '</a></font></td></tr></table>';
            } else {
                Msg1 = '<table cellpadding="1" border="0" cellspacing="0" width="100%" height="100%" id="MsgTable" style="padding-top:80px;"><tr><td valign="middle" height="33%" class="BigHeader" align="center"><font color="Red">' + ErrMsg + '</font>.</td></tr>'
                if (ErrDetail != "") {
                    Msg1 = Msg1 + '<tr><td><br><span style="font-size: 14px; margin-left: 10%;">' + ErrDetail + '</span></td></tr>';
                }
                Msg1 = Msg1 + '<tr><td align="Center"><br><br><a href="' + ReturnLink + '" id="ProceedBtn" data-role="button" rel="external" data-theme="c">' + ProceedMsg + '</a></font></td></tr></table>';
            }
            $("#Msg1").html(Msg1);
            $("#ProceedBtn").button();
            updateTheme();
            return;
        }

        // Evaluate cookies
        if (uid != '' && sessid != '') {
            Msg1 = "";
            if (ErrMsg == "") {
                Msg1 = '<table cellpadding="1" border="0" cellspacing="0" width="100%" height="100%" id="MsgTable" style="padding-top:120px;"><tr><td valign="middle" height="33%" align="center"><h3 style="color:red; align:center;">You are not logged in, and so cannot take this course</h3>'
                        + '</td></tr><tr><td align="Center"><br><br><a href="' + ReturnLink + '" id="ProceedBtn" data-role="button" rel="external" data-theme="c">' + ProceedMsg + '</a></font></td></tr></table>';
            } else {
                Msg1 = '<table cellpadding="1" border="0" cellspacing="0" width="100%" height="100%" id="MsgTable" style="padding-top:80px;"><tr><td valign="middle" height="33%" class="BigHeader" align="center"><font color="Red">' + ErrMsg + '</font>.</td></tr>'
                if (ErrDetail != "") {
                    Msg1 = Msg1 + '<tr><td><br><span style="font-size: 14px; margin-left: 10%;">' + ErrDetail + '</span></td></tr>';
                }
                Msg1 = Msg1 + '<tr><td align="Center"><br><br><a href="' + ReturnLink + '" id="ProceedBtn" data-role="button" rel="external" data-theme="c">' + ProceedMsg + '</a></font></td></tr></table>';
            }
            $("#Msg1").html(Msg1);
            $("#ProceedBtn").button();
            updateTheme();
            if (uid2 == uid && sessid2 == sessid) {
                loggedIn = true;
                return;
            }
            else {
                logoutuser(uid2, sessid2);
                loginuser();
                uid2 = getCookie('ID');
                sessid2 = getCookie('Sess');
                if (uid2 == uid && sessid2 == sessid) {
                    loggedIn = true;
                    return;
                }
            }
        }

        var request = "https://hciscorm.certegrity.com/ls/WsCLogin.ashx?UID="
                + uid2 + "&SES=" + sessid2 + "&HP=" + hosting + "&RL=" + relogin + "&FM=M&callback=?";
        $.getJSON(request, function (JSONData) {
            uid = JSONData.ResultSet.Id;
            sessid = JSONData.ResultSet.SessId;
            redirect = JSONData.ResultSet.Redirect;
            errmsg = JSONData.ResultSet.ErrMsg;
            logout = JSONData.ResultSet.LogOut;
            username = JSONData.ResultSet.Username;
            msgSendFrom = JSONData.ResultSet.EmailAddr;
            domain = JSONData.ResultSet.Domain;

            if (errmsg != '') {
                Msg1 = '<table cellpadding="1" border="0" cellspacing="0" width="100%" height="100%" id="MsgTable" style="padding-top:80px;"><tr><td valign="middle" height="33%" class="BigHeader" align="center"><font color="Red">' + errmsg + '.'
                    + '</td></tr><tr><td align="Center"><br><br><a href="' + ReturnLink + '" id="ProceedBtn" data-role="button" rel="external" data-theme="c">' + ProceedMsg + '</a></font></td></tr></table>';
                $("#Msg1").html(Msg1);
                $("#ProceedBtn").button();
                updateTheme();
                loggedIn = false;
                DeleteCookie("ID", "/", hosting);
                DeleteCookie("Sess", "/", hosting);
                uid = '';
                sessid = '';
                errmsg = '';
                return false;
            }
            if (redirect != '') {
                loggedIn = true;
                var expdate = new Date();
                expdate.setTime(expdate.getTime() + 86400000);
                SetCookie("ID", uid, expdate, "/", "." + hosting);
                SetCookie("Sess", sessid, expdate, "/", "." + hosting);
                Msg1 = '<table cellpadding="1" border="0" cellspacing="0" width="100%" height="100%" id="MsgTable" style="padding-top:80px;"><tr><td valign="middle" height="33%" class="BigHeader" align="center"><font color="Red">' + ErrMsg + '</font>.</td></tr>'
                if (ErrDetail != "") {
                    Msg1 = Msg1 + '<tr><td><br><span style="font-size: 14px; margin-left: 10%;">' + ErrDetail + '</span></td></tr>';
                }
                Msg1 = Msg1 + '<tr><td align="Center"><br><br><a href="' + ReturnLink + '" id="ProceedBtn" data-role="button" rel="external" data-theme="c">' + ProceedMsg + '</a></font></td></tr></table>';
                $("#Msg1").html(Msg1);
                $("#ProceedBtn").button();
            }
        });
    }
</script>
</head>
<body class="ui-mobile-viewport ui-overlay-c">
<div data-role="page" id="reg" data-theme="b" style="align: center; background-color: #f9f9f9; height: 100%;">
<div class="c-interior" id="courseinterior" style="align: center; background-color: #f9f9f9;">
<div data-role="header" data-theme="b" data-position="fixed" data-fullscreen="true" id="courseheader"><h1>Error</h1></div>
<div data-role="content">
<div id="Msg1"><center style="margin-top:150px;"><h3>One moment please...</h3></center></div>
<div id="info1"></div><div id="CourseLocation"></div>
</div></div></div>
</body>
<script type="text/javascript">
    // SCREEN ORIENTATION
    var lockOrientation = screen.lockOrientation || screen.mozLockOrientation || screen.msLockOrientation;
    if (lockOrientation) {
        try { lockOrientation("landscape-primary"); } catch (e) { }
        try { lockOrientation("landscape"); } catch (e) { }
    }

    // PAGE EVENTS
    $.mobile.resetActivePageHeight = (function (prevHandler) {
        return function () {
            var $window = $(window),
                $page = $("." + $.mobile.activePageClass),
                $content = $page.find(".ui-content"),
                scrollTop;
            scrollTop = $window.scrollTop();
            $content.height(0);
            prevHandler.apply(this, arguments);
            $content.css({ height: "" });
            $window.scrollTop(scrollTop);
            $page.trigger("pageresize");
        };
    })($.mobile.resetActivePageHeight);

    $(window.document).on("pageinit", function (event) {
        var $page = $(event.target),
        $header = $page.find(".ui-header"),
        $content = $page.find(".ui-content"),
        $fullHeight = $page.find(".ui-fullheight"),
        extraPageHeight = function () {
            return $page.outerHeight() -
                    $header.outerHeight() -
                    $content.outerHeight();
        };
        if (!$fullHeight.length) {
            return;
        }
        $page.on("pageresize updatelayout", function () {
            $fullHeight
                .filter(":visible:first")
                .each(function () {
                    var $element = $(this),
                        initHeight = $element.jqmData("init-height");
                    if (!initHeight) {
                        initHeight = $element.height();
                        $element.jqmData("init-height", initHeight);
                    }
                    if ($element.height() == initHeight && extraPageHeight() <= 0) {
                        return;
                    }
                    $element
                        .height(0)
                        .height(
                            Math.max(
                                initHeight,
                                extraPageHeight()
                            )
                        );
                });
        });
    });
    $(document).on('pageshow', '#reg', function () {
        updateTheme();
    });
    $.mobile.initializePage();
    // Start
    $("#Msg1").show();
    updateTheme();
    getStatus();
</script>
</html>